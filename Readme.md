# Network Security Vulnerability Assessment

## Random Usefule Things (RUTs)


**Conversion tools**
All these conversions can be tricky. Fortunately, there is a web tool that can easily convert binary to IP and IP to binary.
  - [Browserling IP to Binary Converter](https://www.browserling.com/tools/ip-to-bin)
  - [Browserling Binary to IP Converter](https://www.browserling.com/tools/bin-to-ip)




Date of initial publication. 2/7/2021
I created this repository to capture things I learned on the topic of network security during my certification training at the University of Pensylvania

## Network Security

- **Request and Response Method**
Two-way convrsation b/w client and the server

- **LAN Benefits** Security, speend and performance, easy to add devices

- **WAN** Many LANs connected together, benifit- Able to share resources over a much larger geographic area. Disadvantages- needs encryption for data exchange from LAN to WAN and difficult trouble shooting if outside the LAN- Traffic issues


## Topologies

- **Ring** Can be Uni/Bidirectional, every device is the point of failure, can have slow speed/latency. But there is no central node data manager

- **Linear** Every device is a point of failure, same latency issues

- **Star** Has a centeral node, if that goes down the network goes down but if the a divice fails- that does not affect the network- Easy to extend the network- Distance b/w the central node and the device matter

- **Bus** Fast but wastes brandwith to all the devices equally, two devices cannot transmit data simultaneously

- **Tree** All devices below the the top computer get disconnected from the network 

- **Fully connected** All devices are connected with eachother- very complicated to setup, very difficult to add a device as will require so many connections

- **Mesh** Only a subset of the computers are fully connected 

- **Hybrid** Combination of above- Most modern networks are hybrid

## Data Signals in Binary Bit vs Byte
- 1 bit = 1 or 0. Basically every digit in a binary code is a bit
- 1 byte= `10110111` or 8 bits=1 byte. You can also call 1 byte=1 octet of bits This is 10^8 or 10 million possibilities. This then also means that 4 combinations of different types of 'byte' 10 million bytes = an ip address. For example  `00001010.00000000.00000011.11111110` is an ip address which when interpreted in hexadecimal conversion = `10.0.3.254`. Devices have MAC addreses using which they are able to connect to a network using an ip. The ips are allocated per ISP service provider.  The mac address is used to associate a device to a network. This also means that an ip address itself is a piece of dataa that is used a marker for data packets to distinguish between host and destination. There will always be a host and a destination ip involved during data communication/digital communcation/data exchange. 
      - `00000000` = 0
      - `00000001` = 1
      - `00000010` = 2
      - `00000011` = 3
      - `00000100` = 4
      - `00000101` = 5

- Binary to hexadecimal
- For example, `11000111 00000110 10100110 11100110 11110110 01000110` represents `C7 6 A6 E6 F6 46`. 

- **ASCII  Converts Binary to Hexadecimal and is responsible for visulization of the text on the screen from binary sequence vibrations**

- For example, `01101000 01101001`  represents `hi`. So this means that all letters of the ABC and 123 are converted SPECIFIC pieces of sequences. The human readable version of the binary signal is called **decimal**
- So these so called **hexa-decimals**
- Another way is octects - that system is used in the conversion of human readable IPs. 

## IP Addresses IP Stands for Internet Protocol

- `00001010.00000000.00000011.11111110` = `10.0.3.254` in Octet conversion. Thus 1 IP address is 4 bytes in size. 32 bits=4 bytes. One segment after . is 8bit

There are about 5.9 billion IP addresses of which about 4.3 billion use IPv4, about 3.7 billion IP addresses are public

- Public or Private. The list below are **Private** If its not included in the range below then it is public

- An IP address is always 4 octets or 32 bits, 1 octet = 8 bits

- `192.234.3.0/24` Means that the first 3 octets or first 24 bits are fixed, the last 8 bits after the first 24 or the last octet is variable

- The range of 1 octet or section is between 0 and 255

- `192.243.3.0/24` means the range of IPs is` 192.243.3.0` - `192.243.3.255` which is 256 unique IPs

- IP address `192.243.3.0/0` means all the ips in the world ~4.3 million ipv4

- IP address `192.243.3.0/32` means that there is only one IP and that ip is 192.243.3.0 because it means that first 32 bits must be fixed which is the entire length of the IP address


- **Private IPs** 

```
    |Starting IP  | Ending IP       | IP Addresses Available |  
    |-------------|-----------------|------------------------|
    | 10.0.0.0    | 10.255.255.255  | 16,777,216             |  
    | 172.16.0.0  | 172.31.255.255  | 1,048,576              |
    | 192.168.0.0 | 192.168.255.255 | 65,536                 |
```

- Example of a public IP address: `192.172.69.145`. If in the logs you find a public IP address where I shouldnt exist then it is insight that could possibly link to a hacker


**IPV4-Internet Protocol Version 
 An IP address by IPv4 Standards 

 So by creating a protocol we have used mahematical rules of 1s and 0s on/off to create unique sequences for numbers (0 1 2 3 4 5 7 8 9) such that there is a unique combination of 1s and 0s for each number. 

 Organizations are provided a range of IPs to asign between departments- typical departments are Finance and Marketing


There are 5 classes of IP address and which are decided based on the network part.

```
Class A : 1.0.0.0 - 126.255.255.255 (N.H.H.H)/8
Class B : 128.0.0.0–191.255.255.255 (N.N.H.H)/16
Class C : 192.0.0.0–223.255.255.255 (N.N.N.H)/24
Class D : 224.0.0.0–239.255.255.255 (Multicast IP)
Class E : 240.0.0.0- 255.255.255 (Experimental)
where N= Network part , H=host part , /x = no. of network bits
```
These are called Classfull IP addresses.

Number of networks = 2^N, Number of Hosts inside a network = (2^H)-2

So, 192.168.1.27 is a class C IP address. There is one more concept called Subnetting. It is used to divide the IP network into sub blocks so that each block can be assigned based on the requirements. 192.168.1.27/30 is subnetted network. It is also called classless address. Classless address are the IP addresses which are subnetted. The notation is also called as Classless Interdomain routing(CIDR).

In 192.168.1.27/30, /30 denotes the number of network bits. So, out of 32 bits, 30 bits are network bits and 2 bits are host bits. So, number of hosts inside a network is (2^2)–2= 2



 - **IPv6 protocol**

- IPv6 IP address is `2001:0db8:85a3:0000:0000:8a2e:0370:7334` This 8 groups of 2 bytes in contrast IPv4 is 4 groups each of 1 byte
- IPv6 uses hexadecimal conversion of binary with numbers and letters

**Internet Assigned Numbers Authority (IANA) - Organization that manages the IP addresses**

- This organization assigns the IP addresses to the companies for private/public use

## Layers of the Network - The OSI Model- Open System Interconnections

- **Enumeration** - The process of gathering information about these layers
- Network Layer 1 Physical - How data is physically endoded and decoded
- Network Layer 2 Data Link `ARP` `MAC`. Connects 2 nodes, data intgrity during transport, e-g data transport from switch to computer
- Network Layer 3 Network   `PING`, `traceroute`
- Network Layer 4 Transport `TCP`, `UDP`, `SYN scan`-wireshark
- Network Layer 5 Session 
- Network Layer 6 Presentation
- Network Layer 7 Application

- **Enumeration** Pocess of gathering data regarding a network - This info typically incudes ips, ports, MAC addresses, device information




## Protocols by layer- Standardized rules to define how data is transmitted

**ARP Protocol**
- `ARP Address Resolution Protocol. layer 2 datalink`:  Once the data reaches from the internet to the LAN, it still has to be transported within the LAN, the rules for this transmission are dictated by the ARP protocol. 
- It relies on the MAC address for delivery. Maps MAC to IP, involvs ARP request and response
- Initially the ARP will brodcast the ARP request to identify the MAC address
- This is then stored in the ARP cache- entries of ARP records, once stored in the cache,when the data comes again for the same MAC then it does not need to brodcast the next time.
- This can be examined in WireShark by typing the following
- `arp.opcode == 1` for ARP requests
- `arp.opcode == 2` for ARP responses

- **Spoof ARP or ARP Poisoning Attack** the network can be spoofed by by redirecting the a traffic assigned from an IP address to a different MAC address of the hacker. WireShark can detect this by identifying multiple MAC addresses associated with a single IP address
- Mitigation: Create static ARP entries rather than dynamic- create permanent IP-MAC mapping in the local ARP cache -time consuming

**ICMP Protocol**
- `ICMP INternet Control Message Protocol` Dictates deliver of request to host and replies by error messages if not successful
- This protocol is not used to exchange data between systems. 


**TCP Transmission Control Protocol**
- Most commonly used protocol for data transmission. is used with familiar protocols such as HTTP, HTTPS, FTP, SSH, and SMTP.
- The three-way-handshake process is broken down into three steps:
  1. **SYN**: (_Synchronize_) From client to server.
  -   `tcp.flags.syn ==1 && tcp.flags.ack == 0` This filters SYN requests in Wireshark
  2. **SYN/ACK**: (_Synchronize/Acknowledge_) From server to client.
  -   `tcp.flags.syn ==1 && tcp.flags.ack == 1` This filters SYNACK requests in WireShark
  3. **ACK**: (_Acknowledge_) From client to server.
  -   `tcp.flags.syn == 0 && tcp.flags.ack == 1`

- Seeing Domain in WireShark  `View` > `Name Resolution` > `Resolve Network Address`


- The four-way termination process is broken up into four steps
  1. **FIN**: (_Finish_) From client to server giving message of termination of the connection     
  2. **ACK**: (_Acknowledge_) From server to client. Acknowledgement of the message    
  3. **FIN**: (_Finish_) From server to client. Actual termination and sending of FIN packet to the client
  4. **ACK**: (_Acknowledge_) From client to server. Client acknowledges the reciept of FIN packet
- TCP used when complete data transmission is required, it can cause delays if there are repeat transmissions.

**UDP**
- `UDP User Datagram Protocol` Transports datagrams. It is a connectionless protocol as the complete transmission of the datagram is not a requirement and thus no 3 way handshake is required. 
- Used when complete data transmission is not a requirement e-g streaming video, audio
- If all the packets are not received it is fine. 
- Sends `datagrams` 



## Ports

- Ports are either open (accepting connections), closed (not accpeting connections) or filtered (Means that the port maybe open, but is blocked by a firewall)
- Both ip address and port numbers are required to transport data

**Classification of Ports**

- The computer has different ports for transmitted data- they are **physical ports**. There are also **Virtual ports** assigned to certain protocols like HTTPS

- Home address is like the IP address, room location is the port

- These are access points for sending and receiving data

- Doors can be open and closed and accessed. So they must not be open unless for specific use/protocol such as internet HTTPS

- Acess to ports must be authorized

- Ports host protocol or service, can send/receive data

- Port `80`: **HTTP** - For sending web traffic.

- Port `443`: **HTTPS** - For sending encrypted web traffic.

- Port `21`: **FTP** - For sending files.

- Port `22`: **SSH** - For operating network services securely.

- Port `25`: **SMTP** - For sending emails.

- Port `53`: **DNS** - For translating domains to IP addresses.

- `0`-`1023` Admin level - contains ports for system services including various protocols

- `1024`-`49151` These can be controlled by the users. 

- `49152` - `65536` These are **source ports** that are are used by the client and are dynamically/randomly

**Examples of how Logs can be used to deterimine what the users were accessing**

 `Src Port: 11519, Dst Port: 80`
 
**Log Record 1**
 
  - Source Port: `11519`
  - Destination Port: `80`
  - Destination Protocol: `HTTP`
  - Protocol Summary: Sally Stealer is likely accessing an unencrypted website.


**Log Record 2**		
  
  - Source Port: `53367`
  - Destination Port: `443`
  - Destination Protocol: `HTTPS`
  - Protocol Summary: Sally Stealer is likely accessing a website with encrypted traffic.

**Log Record 3**

  - Source Port: `34836`
  - Destination Port: `21`
  - Destination Protocol: `FTP`
  - Protocol Summary: Sally Stealer is likely using FTP to transfer files.


## DNS HighJacking

## Commands 
- **Ping stands for Packet Inter-Network Groper** It occurs in the layer 3 - the network layer of the network. 
- `ping` to check if the hosts are accepting connections. `ping -c 4 pepsi.com` = `ping -c 4 45.60.135.51`
- `fping` Checking multiple pings at the same time. `sudo apt install fping` for installing this command
- Pinging multiple ids
- `fping -g [starting IP of range] [ending IP of range]` I can also use /subnet valuw as below instead of manually trying to calculate the range. 
- `fping -g 15.199.95.91/28` the flags of `-c` followed by the number instructs to ping each ip in the range the specified number of times. In addition `-r` followed by the number specifies the number of times the process should be repeated. 

- `sudo traceroute -I redbull.com` traceroute is used to check the number of nodes -router connections to define the pathway

- Output

```
traceroute to redbull.com (213.227.189.20), 30 hops max, 60 byte packets
4  012-034-056-789.res.spectrum.com (12.34.56.789)  15.567 ms  16.471 ms  16.438 ms
```

-  `4` is the first hop and `12.34.56.789` is the ip of the first hop and the times are the response times for the ICMP request (Internet control message protocol). 30hops is the max allowed

## SYN Scan

- This scan evaluates the the Network layer or layer 3 of the network layers

- Checking port status to see which ports are **open**, **closed** or **filtered**

- **Filtered Port** - These ports are not available to public
- You will only see SYN request (only 1 packet) no SYN/ACK on stream transmission on WireShack

- **Closed Port** - Likely because they are protected by the firewall and do not let you establish a connection
- You will only see SYN and SYN/RST (2 packets) on stream transmission on Wireshack

- **Open Port**
- You will see SYN and SYN/RST and  RST or SYN

- Only SYN `tcp.flags.syn ==1 && tcp.flags.ack == 0`
- Only SYN/ACK `tcp.flags.syn ==1 && tcp.flags.ack == 1` THis is the most imp in syn scan as it indicates that the port is open
- Only ACK `tcp.flags.syn == 0 && tcp.flags.ack == 1`
- Only FIN    `tcp.flags.fin == 1` This will  filter the list of termination packet only

- To inspect the packet in WireShark, we select the stream then right click and then select follow stream transmission. From the top sections select Statics and then conversation. Now in the follow stream transmission window you will see all the ports that have 3 packets or 2 or 1 or 0


- [RST] Tells the server to terminate a connection
- SYN scan also hwlps with distinguishing betwen the client and the server
