## Networking Fundamentals Homework: Rocking your Network!

You have just been hired by RockStar Corporation as a network security analyst.

- RockStar Corp has recently built a new office in Hollywood, California. You are tasked with completing a **network vulnerability assessment** of the office.

- You will complete several steps in order to analyze the Hollywood network and then provide RockStar Corp a summary of your findings.

- RockStar Corp is also concerned that a hacker may have infiltrated their Hollywood office. You will need to determine if there is anything suspicious in your findings.

### Files Required

RockStar Corp has provided you with:

- A list of their network assets: [Rock Star Server List](resources/Rockstarserverlist.xlsx)
- Instructions to scan their network.

### Your Goal

You will follow instructions to work through four phases of the network assessment. For each phase, include the following:

- The steps and commands used to complete the tasks.

- A summary of your findings for each testing phase.

- Any network vulnerabilities discovered.

- Findings associated with a hacker.

- Recommended mitigation strategy.

- Document the OSI layer where the findings were found.


### Topics Covered in Your Assignment

- Subnetting
- CIDR
- IP Addresses
- `fping`
- OSI Model and OSI Layers
- Protocols
- Ports
- Wireshark
- PCAP Analysis
- `DNS`
- `HTTP`
- `ARP`
- `Syn` Scan
- `TCP`
- `nslookup`
- Network Vulnerability Assessments
- Network Vulnerability Mitigation

---

### Network Vulnerability Assessment Instructions

Please note that you will be using your Vagrant virtual machine for this homework.

### **Phase 1**: _"I'd like to Teach the World to `Ping`"_

You have been provided a list of network assets belonging to RockStar Corp. Use `fping` to ping the network assets for only the Hollywood office.

  - Determine the IPs for the Hollywood office and run `fping` against the IP ranges in order to determine which IP is accepting connections.

  >Answer: Below are the IP ranges associated with the Hollywood Netwok
```
15.199.95.91/28      
15.199.94.91/28     
11.199.158.91/28    
167.172.144.11/32   Only one IP 167.172.144.11
11.199.141.91/28    
```

  - RockStar Corp doesn't want any of their servers, even if they are up, indicating that they are accepting connections.
     - Use `fping <IP Address>` and ignore any results that say "Request timed out".
     - If any of the IP addresses send back a Reply, enter Ctrl+C to stop sending requests.

  - Create a summary file in a word document that lists out the `fping` command used, as well as a summary of the results.
 Answer: 

  - Your summary should determine which IPs are accepting connections and which are not.

 The commands used are:
- `fping -g [starting IP of range] [ending IP of range]` I can also use /subnet valuw as below instead of manually trying to calculate the range. 
- `fping -g 15.199.95.91/28`      
- `fping -g 15.199.94.91/28`     
- `fping -g 11.199.158.91/28`    
- `fping -g 167.172.144.11/32` 
- `fping -g 11.199.141.91/28`

Only the ip `167.172.144.11` is alive or accepting connection, all the other IPs are closed. Please see the output below:

```
sysadmin@UbuntuDesktop:~$ fping -g 15.199.95.91/28
15.199.95.81 is unreachable
15.199.95.82 is unreachable
15.199.95.83 is unreachable
15.199.95.84 is unreachable
15.199.95.85 is unreachable
15.199.95.86 is unreachable
15.199.95.87 is unreachable
15.199.95.88 is unreachable
15.199.95.89 is unreachable
15.199.95.90 is unreachable
15.199.95.91 is unreachable
15.199.95.92 is unreachable
15.199.95.93 is unreachable
15.199.95.94 is unreachable
sysadmin@UbuntuDesktop:~$ fping -g 15.199.95.91/28   
15.199.95.81 is unreachable
15.199.95.82 is unreachable
15.199.95.83 is unreachable
15.199.95.84 is unreachable
15.199.95.85 is unreachable
15.199.95.86 is unreachable
15.199.95.87 is unreachable
15.199.95.88 is unreachable
15.199.95.89 is unreachable
15.199.95.90 is unreachable
15.199.95.91 is unreachable
15.199.95.92 is unreachable
15.199.95.93 is unreachable
15.199.95.94 is unreachable
sysadmin@UbuntuDesktop:~$ fping -g 15.199.94.91/28
15.199.94.81 is unreachable
15.199.94.82 is unreachable
15.199.94.83 is unreachable
15.199.94.84 is unreachable
15.199.94.85 is unreachable
15.199.94.86 is unreachable
15.199.94.87 is unreachable
15.199.94.88 is unreachable
15.199.94.89 is unreachable
15.199.94.90 is unreachable
15.199.94.91 is unreachable
15.199.94.92 is unreachable
15.199.94.93 is unreachable
15.199.94.94 is unreachable
sysadmin@UbuntuDesktop:~$ fping -g 11.199.158.91/28
11.199.158.81 is unreachable
11.199.158.82 is unreachable
11.199.158.83 is unreachable
11.199.158.84 is unreachable
11.199.158.85 is unreachable
11.199.158.86 is unreachable
11.199.158.87 is unreachable
11.199.158.88 is unreachable
11.199.158.89 is unreachable
11.199.158.90 is unreachable
11.199.158.91 is unreachable
11.199.158.92 is unreachable
11.199.158.93 is unreachable
11.199.158.94 is unreachable
sysadmin@UbuntuDesktop:~$ fping -g 167.172.144.11/32
167.172.144.11 is alive
sysadmin@UbuntuDesktop:~$ fping -g 11.199.141.91/28
11.199.141.81 is unreachable
11.199.141.82 is unreachable
11.199.141.83 is unreachable
11.199.141.84 is unreachable
11.199.141.85 is unreachable
11.199.141.86 is unreachable
11.199.141.87 is unreachable
11.199.141.88 is unreachable
11.199.141.89 is unreachable
11.199.141.90 is unreachable
11.199.141.91 is unreachable
11.199.141.92 is unreachable
11.199.141.93 is unreachable
11.199.141.94 is unreachable
  ```
  - Also indicate at which OSI layer your findings are found.
  > Answer: 
  The network layer, layer 3

### **Phase 2**:  _"Some `Syn` for Nothin`"_

With the IP(s) found from Phase 1, determine which ports are open:

  - You will run a `SYN SCAN` against the IP accepting connections. See **SYN SCAN Instructions** below.

>Answer:

Using the instructions below I am typing the following commands

`sudo nmap -sS 167.172.144.11`

- The output is below
```
Starting Nmap 7.60 ( https://nmap.org ) at 2021-02-16 19:39 EST
Nmap scan report for 167.172.144.11nslookup 
Host is up (0.0013s latency).
Not shown: 990 filtered ports
PORT     STATE  SERVICE
21/tcp   closed ftp
22/tcp   open   ssh
113/tcp  closed ident
554/tcp  closed rtsp
587/tcp  closed submission
993/tcp  closed imaps
995/tcp  closed pop3s
1720/tcp closed h323q931
3389/tcp closed ms-wbt-server
5900/tcp closed vnc
```

  - Using the results of the `SYN SCAN`, determine which ports are accepting connections.

  > Answer
  Only the port 22 using the protocol ssh is open

  - Add these findings to the summary and be sure to indicate at which OSI layer your findings were found.

  > Answer
  - It occurs at layer 3 or the network layer of the OSI layers

#### `SYN SCAN`  Instructions

What is **Nmap**?

  - **Nmap** is a free networking scanning tool available for Linux distributions.

  - Security professionals use Nmap to determine the devices running on a network, as well as finding open ports to determine potential security vulnerabilities.

  - Nmap has many capabilities and commands that can be run. Here is a cheat sheet for reference:  https://www.stationx.net/nmap-cheat-sheet/.

For this activity, we will specifically focus on the Nmap capability of running a SYN SCAN.
nslookup 
  - We have already covered that a SYN SCAN is an automated method to check for the states of ports on a network, Nmap is simply a tool that can automate this task.

To run a SYN SCAN:

  - Open up the terminal within your Linux machine.

  - The command to run a SYN SCAN is `nmap -sS  <IP Address>`.

    - For example, if you wanted to run a SYN SCAN against the server IP of `74.207.244.221`, you would run `nmap -sS 74.207.244.221` and press enter.

    - This will scan the most common 1000 ports.

  - After this runs for several minutes, it should return a similar result that depicts the state of the ports on that server:

        Starting Nmap 7.70 ( https://nmap.org ) at 2019-08-14 11:51 EDT
        Nmap scan report for li86-221.members.linode.com (74.207.244.221)
        Host is up (1.4s latency).
        Not shown: 988 closed ports
        PORT    STATE    SERVICE
        22/tcp  open     ssh
        25/tcp  filtered smtp
        110/tcp open     pop3
        113/tcp filtered ident
        135/tcp filtered msrpc
        139/tcp filtered netbios-ssn
        143/tcp open     imap
        445/tcp filtered microsoft-ds
        465/tcp open     smtps
        587/tcp open     submission
        993/tcp open     imaps
        995/tcp open     pop3s

  - The results show the port number / TCP / UDP , the state of the port, and the service / protocol for the ports that are either open or filtered (stopped by a firewall).

  - Closed ports are not shown, indicated on the line:  `Not shown: 988 closed ports`.

  - For the purpose of this exercise, document which ports are open on the RockStar Corp server, and which OSI layer SYN scans run on.

### Phase 3: _"I Feel a `DNS` Change Comin' On"_

With your findings from Phase 2, determine if you can access the server that is accepting connections.

- RockStar typically uses the same default username and password for most of their servers, so try this first:

  - **Username:**   `jimi`

  - **Password:**   `hendrix`

- Try to figure out which port/service would be used for remote system administration, and then using these credentials, attempt to log into the IP that responded to pings from **Phase 1**.


> From the above output We can determine that the open port is 22 and the service is ssh. Unable to log into the ip 167.172.144.11

- However using the ssh I can connect to the server

`ssh jimi@167.172.144.11 -p22` 

- This step prompted for pw which I typed as `hendrix` and it worked. See output below

```
sysadmin@UbuntuDesktop:~$ ssh jimi@167.172.144.11 -p22
The authenticity of host '167.172.144.11 (167.172.144.11)' can't be established.
ECDSA key fingerprint is SHA256:mDZ8+Ud+K3Y6XNWvtyAR4Q2ti1+/V3p0Bm83hF6Ua4w.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '167.172.144.11' (ECDSA) to the list of known hosts.
jimi@167.172.144.11's password: 
Linux GTscavengerHunt 4.9.0-11-amd64 #1 SMP Debian 4.9.189-3+deb9u1 (2019-09-20) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Feb 17 02:32:55 2021 from 24.124.99.136
Could not chdir to home directory /home/jimi: No such file or directory
```

- Then I got root access and I navigated to the host files using `nano ~etc/hosts` and I found the following information:

```
127.0.1.1 GTscavengerHunt.localdomain GTscavengerHunt
127.0.0.1 localhost
98.137.246.8 rollingstone.com

oooooooollowing lines are desirable for IPv6 capable hosts
::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts

```



RockStar Corp recently reported that they are unable to access `rollingstone.com` in the Hollywood office. Sometimes when they try to access the website, a different, unusual website comes up.

  - While logged into the RockStar server from the previous step, determine if something was modified on this system that might affect viewing `rollingstone.com` within the browser. When you successfully find the configuration file, record the entry that is set to `rollingstone.com`.

  - Terminate your ssh session to the rollingstone server, and use `nslookup` to determine the real domain of the IP address you found from the previous step.

> Terminated by typing exit


    - **Note**: **nslookup** is a command line utility that can work in Windows or Linux Systems. It is designed to query Domain Name System records. You can use PowerShell or  MacOS/Linux terminal to run `nslookup`.

    - To run **nslookup**, simply enter the following on the command line:

      `nslookup <IP Address>` to find the domain associated to an IP address

      OR

      `nslookup <domain name>` to find the IP address associated to a domain

    - You'll know you found the right domain if it begins with `media-`.

  - Add your findings to your summary and be sure to indicate which OSI layer they were found on.
  > Answer

  - On inspection of the hosts file I found that the following was associated with the rollingstone website
``
  ```
127.0.1.1 GTscavengerHunt.localdomain GTscavengerHunt
127.0.0.1 localhost
98.137.246.8 rollingstone.com
```

These findings are located at the 
 ### Phase 4:  _"Sh`ARP` Dressed Man"_

Within the RockStar server that you SSH'd into, and in the same directory as the configuration file from **Phase 3**, the hacker left a note as to where he stored away some packet captures.  

- View the file to find where to recover the packet captures.

>Answer

-After navigating into the etc folder I found a text file called packetcaptureinfo.txt

`cat packetcaptureinfo.txt`

```
 Captured Packets are here:
 https://drive.google.com/file/d/1ic-CFFGrbruloYrWaw3PvT71elTkh3eF/view?usp=sharing
```



- These are packets that were captured from the activity in the Hollywood Office.

- Use Wireshark to analyze this pcap file and determine if there was any suspicious activity that could be attributed to a hacker.

  - **Hint**: Focus on the ARP and HTTP protocols. Recall the different types of HTTP request methods and be sure to thoroughly examine the contents of these packets.

- Add your findings in your summary and be sure to indicate at which OSI layer they were found.

- There is a duplicate 


### Your Submission:  _"Its the End of the Assessment as We Know It, and I Feel Fine"_

#### Guidelines for your Submission:

Provide the following for each phase:

  - List the steps and commands used to complete the tasks.

  - List any vulnerabilities discovered.

  - List any findings associated to a hacker.

  - Document the mitigation recommendations to protect against the discovered vulnerabilities.

  - Document the OSI layer where the findings were found.


For example:

**Phase 1**

- Determined the IP ranges to scan were `1.1.1.1` and `2.2.2.2`, then ran `fping` against `1.1.1.1` and `2.2.2.2`.

  - Used the following commands to run `fping`:

    - `fping 1.1.1.1 `

- Determined a potential vulnerability that IP `1.1.1.1` is responding.

  - Since RockStar Corp doesn't want to respond to any requests, this is a vulnerability.

- Recommend to restrict allowing ICMP echo requests against IP `1.1.1.1` to prevent successful responses from PING requests.

- This occurred on the network layer as Ping uses IP addresses and IPs are used on the Network Layer.



---

© 2020 Trilogy Education Services, a 2U, Inc. brand. All Rights Reserved.
